(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
"use strict";
var random_1 = require("./utils/random");
var range_1 = require("./utils/range");
var canvas = document.createElement('canvas');
var slider = document.createElement('input');
var gl = canvas.getContext('webgl');
if (gl == null) {
    throw new Error('gl context could not be obtained');
}
var MAX_VEC4_UNIFORM_SIZE = gl.getParameter(gl.MAX_VERTEX_UNIFORM_VECTORS);
var SPHERE_COUNT = MAX_VEC4_UNIFORM_SIZE / 4;
var AREA = [800, 450];
var radii = new Float32Array(SPHERE_COUNT);
var positions = new Float32Array(2 * SPHERE_COUNT);
var velocities = new Float32Array(2 * SPHERE_COUNT);
var settings = {
    K: 0.1,
    color: [.2, .4, .8]
};
for (var i = 0; i < SPHERE_COUNT; i++) {
    radii[i] = random_1.randInt(4, 30);
    positions[i * 2] = random_1.randInt(0, AREA[0]);
    positions[i * 2 + 1] = random_1.randInt(0, AREA[1]);
    velocities[i * 2] = random_1.randInt(-4, 4);
    velocities[i * 2 + 1] = random_1.randInt(-4, 4);
}
var vsrc = "\nprecision mediump float;\n\nattribute vec2 a_vertices;\n\nvoid main () {\n  gl_Position = vec4(a_vertices, 1.0, 1.0);\n}\n";
var fsrc = "\nprecision mediump float;\n\nuniform vec2 u_resolution;\nuniform float u_time;\nuniform float u_K;\nuniform vec3 u_color;\nuniform float u_radii [ " + SPHERE_COUNT + " ];\nuniform vec2 u_positions [ " + SPHERE_COUNT + " ];\n\nfloat sdf_sphere ( float r, vec2 c, vec2 p ) {\n  return distance(p, c) - r;\n}\n\nvoid main () {\n  vec2 p = gl_FragCoord.xy;\n  float dist = 0.;\n\n  for ( int i = 0; i < " + SPHERE_COUNT + "; i++ ) {\n    dist += exp(-u_K * sdf_sphere(u_radii[i], u_positions[i], p));\n  }\n  dist = -log(dist) / u_K;\n  float opacity = clamp(.5 - dist, 0.0, 1.0);\n\n  gl_FragColor = vec4(u_color, opacity);\n}\n";
var vertex = gl.createShader(gl.VERTEX_SHADER);
var fragment = gl.createShader(gl.FRAGMENT_SHADER);
var program = gl.createProgram();
var screenQuad = new Float32Array([
    -1, 1, -1, -1, 1, -1,
    -1, 1, 1, -1, 1, 1
]);
var quadSize = screenQuad.length / 2;
if (vertex == null && fragment == null && program == null) {
    throw new Error('gl resources could not be obtained');
}
gl.shaderSource(vertex, vsrc);
gl.compileShader(vertex);
gl.shaderSource(fragment, fsrc);
gl.compileShader(fragment);
gl.attachShader(program, vertex);
gl.attachShader(program, fragment);
gl.linkProgram(program);
gl.useProgram(program);
if (!gl.getProgramParameter(program, gl.LINK_STATUS)) {
    console.log(gl.getShaderInfoLog(vertex));
    console.log(gl.getShaderInfoLog(fragment));
    console.log(gl.getProgramInfoLog(program));
}
var verticesBuffer = gl.createBuffer();
var a_locations = {
    a_vertices: gl.getAttribLocation(program, 'a_vertices')
};
var u_locations = {
    u_K: gl.getUniformLocation(program, 'u_K'),
    u_color: gl.getUniformLocation(program, 'u_color'),
    u_time: gl.getUniformLocation(program, 'u_time'),
    u_resolution: gl.getUniformLocation(program, 'u_resolution'),
    u_radii: gl.getUniformLocation(program, 'u_radii'),
    u_positions: gl.getUniformLocation(program, 'u_positions')
};
gl.bindBuffer(gl.ARRAY_BUFFER, verticesBuffer);
gl.enableVertexAttribArray(a_locations.a_vertices);
gl.vertexAttribPointer(a_locations.a_vertices, 2, gl.FLOAT, false, 0, 0);
gl.bufferData(gl.ARRAY_BUFFER, screenQuad, gl.STATIC_DRAW);
slider.type = 'range';
slider.min = '0';
slider.max = '0.1';
slider.step = '0.01';
slider.value = settings.K.toString();
slider.addEventListener('input', function (_) { return settings.K = Number(slider.value); });
canvas.width = AREA[0];
canvas.height = AREA[1];
canvas.style.boxSizing = 'border-box';
canvas.style.border = '2px solid Coral';
document.body.style.margin = '0',
    document.body.style.backgroundColor = 'MistyRose';
document.body.appendChild(canvas);
document.body.appendChild(slider);
gl.viewport(0, 0, AREA[0], AREA[1]);
gl.enable(gl.CULL_FACE);
gl.clearColor(0, 0, 0, 0);
gl.useProgram(program);
var start = Date.now();
var raf = window.requestAnimationFrame;
raf(function render() {
    var time = Date.now();
    var buffer = 1.05;
    if (time - start > 1000) {
        for (var i = 0; i < 2 * SPHERE_COUNT; i += 2) {
            positions[i] = range_1.wrap(-AREA[0] * buffer, AREA[0] * buffer, positions[i] + velocities[i]);
            positions[i + 1] = range_1.wrap(-AREA[1] * buffer, AREA[1] * buffer, positions[i + 1] + velocities[i + 1]);
        }
    }
    gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);
    gl.uniform1f(u_locations.u_time, time);
    gl.uniform2f(u_locations.u_resolution, AREA[0], AREA[1]);
    gl.uniform1f(u_locations.u_K, settings.K);
    gl.uniform3f(u_locations.u_color, settings.color[0], settings.color[1], settings.color[2]);
    gl.uniform1fv(u_locations.u_radii, radii);
    gl.uniform2fv(u_locations.u_positions, positions);
    gl.drawArrays(gl.TRIANGLES, 0, quadSize);
    raf(render);
});

},{"./utils/random":2,"./utils/range":3}],2:[function(require,module,exports){
"use strict";
function randInt(min, max) {
    return Math.floor(Math.random() * (max - min) + min);
}
exports.randInt = randInt;

},{}],3:[function(require,module,exports){
"use strict";
function wrap(min, max, val) {
    if (val > max)
        return min + (val - max);
    else if (val < min)
        return max + (min - val);
    else
        return val;
}
exports.wrap = wrap;

},{}]},{},[1])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3Vzci9sb2NhbC9saWIvbm9kZV9tb2R1bGVzL3dhdGNoaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvbWFpbi50cyIsInNyYy91dGlscy9yYW5kb20udHMiLCJzcmMvdXRpbHMvcmFuZ2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7O0FDQUEseUNBQXdDO0FBQ3hDLHVDQUFvQztBQUVwQyxJQUFNLE1BQU0sR0FBRyxRQUFRLENBQUMsYUFBYSxDQUFDLFFBQVEsQ0FBQyxDQUFBO0FBQy9DLElBQU0sTUFBTSxHQUFHLFFBQVEsQ0FBQyxhQUFhLENBQUMsT0FBTyxDQUFDLENBQUE7QUFDOUMsSUFBTSxFQUFFLEdBQUcsTUFBTSxDQUFDLFVBQVUsQ0FBQyxPQUFPLENBQUMsQ0FBQTtBQUVyQyxFQUFFLENBQUMsQ0FBRSxFQUFFLElBQUksSUFBSyxDQUFDLENBQUMsQ0FBQztJQUNqQixNQUFNLElBQUksS0FBSyxDQUFDLGtDQUFrQyxDQUFDLENBQUE7QUFDckQsQ0FBQztBQUVELElBQU0scUJBQXFCLEdBQUcsRUFBRSxDQUFDLFlBQVksQ0FBQyxFQUFFLENBQUMsMEJBQTBCLENBQUMsQ0FBQTtBQUM1RSxJQUFNLFlBQVksR0FBRyxxQkFBcUIsR0FBRyxDQUFDLENBQUE7QUFDOUMsSUFBTSxJQUFJLEdBQUcsQ0FBRSxHQUFHLEVBQUUsR0FBRyxDQUFFLENBQUE7QUFFekIsSUFBTSxLQUFLLEdBQUcsSUFBSSxZQUFZLENBQUMsWUFBWSxDQUFDLENBQUE7QUFDNUMsSUFBTSxTQUFTLEdBQUcsSUFBSSxZQUFZLENBQUMsQ0FBQyxHQUFHLFlBQVksQ0FBQyxDQUFBO0FBQ3BELElBQU0sVUFBVSxHQUFHLElBQUksWUFBWSxDQUFDLENBQUMsR0FBRyxZQUFZLENBQUMsQ0FBQTtBQUNyRCxJQUFNLFFBQVEsR0FBRztJQUNmLENBQUMsRUFBRSxHQUFHO0lBQ04sS0FBSyxFQUFFLENBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLENBQUU7Q0FDdEIsQ0FBQTtBQUVELEdBQUcsQ0FBQyxDQUFFLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsWUFBWSxFQUFFLENBQUMsRUFBRSxFQUFHLENBQUM7SUFDeEMsS0FBSyxDQUFDLENBQUMsQ0FBQyxHQUFHLGdCQUFPLENBQUMsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFBO0lBQ3pCLFNBQVMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsZ0JBQU8sQ0FBQyxDQUFDLEVBQUUsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUE7SUFDdEMsU0FBUyxDQUFDLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsZ0JBQU8sQ0FBQyxDQUFDLEVBQUUsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUE7SUFDMUMsVUFBVSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxnQkFBTyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFBO0lBQ2xDLFVBQVUsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLGdCQUFPLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUE7QUFDeEMsQ0FBQztBQUVELElBQU0sSUFBSSxHQUNWLDhIQVFDLENBQUE7QUFFRCxJQUFNLElBQUksR0FDVix5SkFPMkIsWUFBWSx3Q0FDVCxZQUFZLDRMQVVoQixZQUFZLG1OQVFyQyxDQUFBO0FBRUQsSUFBTSxNQUFNLEdBQUcsRUFBRSxDQUFDLFlBQVksQ0FBQyxFQUFFLENBQUMsYUFBYSxDQUFDLENBQUE7QUFDaEQsSUFBTSxRQUFRLEdBQUcsRUFBRSxDQUFDLFlBQVksQ0FBQyxFQUFFLENBQUMsZUFBZSxDQUFDLENBQUE7QUFDcEQsSUFBTSxPQUFPLEdBQUcsRUFBRSxDQUFDLGFBQWEsRUFBRSxDQUFBO0FBQ2xDLElBQU0sVUFBVSxHQUFHLElBQUksWUFBWSxDQUFDO0lBQ2xDLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDO0lBQ3BCLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUM7Q0FDbkIsQ0FBQyxDQUFBO0FBQ0YsSUFBTSxRQUFRLEdBQUcsVUFBVSxDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUE7QUFFdEMsRUFBRSxDQUFDLENBQUUsTUFBTSxJQUFJLElBQUksSUFBSSxRQUFRLElBQUksSUFBSSxJQUFJLE9BQU8sSUFBSSxJQUFLLENBQUMsQ0FBQyxDQUFDO0lBQzVELE1BQU0sSUFBSSxLQUFLLENBQUMsb0NBQW9DLENBQUMsQ0FBQTtBQUN2RCxDQUFDO0FBRUQsRUFBRSxDQUFDLFlBQVksQ0FBQyxNQUFNLEVBQUUsSUFBSSxDQUFDLENBQUE7QUFDN0IsRUFBRSxDQUFDLGFBQWEsQ0FBQyxNQUFNLENBQUMsQ0FBQTtBQUN4QixFQUFFLENBQUMsWUFBWSxDQUFDLFFBQVEsRUFBRSxJQUFJLENBQUMsQ0FBQTtBQUMvQixFQUFFLENBQUMsYUFBYSxDQUFDLFFBQVEsQ0FBQyxDQUFBO0FBRTFCLEVBQUUsQ0FBQyxZQUFZLENBQUMsT0FBTyxFQUFFLE1BQU0sQ0FBQyxDQUFBO0FBQ2hDLEVBQUUsQ0FBQyxZQUFZLENBQUMsT0FBTyxFQUFFLFFBQVEsQ0FBQyxDQUFBO0FBQ2xDLEVBQUUsQ0FBQyxXQUFXLENBQUMsT0FBTyxDQUFDLENBQUE7QUFDdkIsRUFBRSxDQUFDLFVBQVUsQ0FBQyxPQUFPLENBQUMsQ0FBQTtBQUV0QixFQUFFLENBQUMsQ0FBRSxDQUFDLEVBQUUsQ0FBQyxtQkFBbUIsQ0FBQyxPQUFPLEVBQUUsRUFBRSxDQUFDLFdBQVcsQ0FBRSxDQUFDLENBQUMsQ0FBQztJQUN2RCxPQUFPLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxnQkFBZ0IsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFBO0lBQ3hDLE9BQU8sQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLGdCQUFnQixDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUE7SUFDMUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsaUJBQWlCLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQTtBQUM1QyxDQUFDO0FBRUQsSUFBTSxjQUFjLEdBQUcsRUFBRSxDQUFDLFlBQVksRUFBRSxDQUFBO0FBQ3hDLElBQU0sV0FBVyxHQUFHO0lBQ2xCLFVBQVUsRUFBRSxFQUFFLENBQUMsaUJBQWlCLENBQUMsT0FBTyxFQUFFLFlBQVksQ0FBQztDQUN4RCxDQUFBO0FBQ0QsSUFBTSxXQUFXLEdBQUc7SUFDbEIsR0FBRyxFQUFFLEVBQUUsQ0FBQyxrQkFBa0IsQ0FBQyxPQUFPLEVBQUUsS0FBSyxDQUF5QjtJQUNsRSxPQUFPLEVBQUUsRUFBRSxDQUFDLGtCQUFrQixDQUFDLE9BQU8sRUFBRSxTQUFTLENBQXlCO0lBQzFFLE1BQU0sRUFBRSxFQUFFLENBQUMsa0JBQWtCLENBQUMsT0FBTyxFQUFFLFFBQVEsQ0FBeUI7SUFDeEUsWUFBWSxFQUFFLEVBQUUsQ0FBQyxrQkFBa0IsQ0FBQyxPQUFPLEVBQUUsY0FBYyxDQUF5QjtJQUNwRixPQUFPLEVBQUUsRUFBRSxDQUFDLGtCQUFrQixDQUFDLE9BQU8sRUFBRSxTQUFTLENBQXlCO0lBQzFFLFdBQVcsRUFBRSxFQUFFLENBQUMsa0JBQWtCLENBQUMsT0FBTyxFQUFFLGFBQWEsQ0FBeUI7Q0FDbkYsQ0FBQTtBQUVELEVBQUUsQ0FBQyxVQUFVLENBQUMsRUFBRSxDQUFDLFlBQVksRUFBRSxjQUFjLENBQUMsQ0FBQTtBQUM5QyxFQUFFLENBQUMsdUJBQXVCLENBQUMsV0FBVyxDQUFDLFVBQVUsQ0FBQyxDQUFBO0FBQ2xELEVBQUUsQ0FBQyxtQkFBbUIsQ0FBQyxXQUFXLENBQUMsVUFBVSxFQUFFLENBQUMsRUFBRSxFQUFFLENBQUMsS0FBSyxFQUFFLEtBQUssRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUE7QUFDeEUsRUFBRSxDQUFDLFVBQVUsQ0FBQyxFQUFFLENBQUMsWUFBWSxFQUFFLFVBQVUsRUFBRSxFQUFFLENBQUMsV0FBVyxDQUFDLENBQUE7QUFFMUQsTUFBTSxDQUFDLElBQUksR0FBRyxPQUFPLENBQUE7QUFDckIsTUFBTSxDQUFDLEdBQUcsR0FBRyxHQUFHLENBQUE7QUFDaEIsTUFBTSxDQUFDLEdBQUcsR0FBRyxLQUFLLENBQUE7QUFDbEIsTUFBTSxDQUFDLElBQUksR0FBRyxNQUFNLENBQUE7QUFDcEIsTUFBTSxDQUFDLEtBQUssR0FBRyxRQUFRLENBQUMsQ0FBQyxDQUFDLFFBQVEsRUFBRSxDQUFBO0FBQ3BDLE1BQU0sQ0FBQyxnQkFBZ0IsQ0FBQyxPQUFPLEVBQUUsVUFBQSxDQUFDLElBQUksT0FBQSxRQUFRLENBQUMsQ0FBQyxHQUFHLE1BQU0sQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLEVBQWpDLENBQWlDLENBQUMsQ0FBQTtBQUV4RSxNQUFNLENBQUMsS0FBSyxHQUFHLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQTtBQUN0QixNQUFNLENBQUMsTUFBTSxHQUFHLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQTtBQUN2QixNQUFNLENBQUMsS0FBSyxDQUFDLFNBQVMsR0FBRyxZQUFZLENBQUE7QUFDckMsTUFBTSxDQUFDLEtBQUssQ0FBQyxNQUFNLEdBQUcsaUJBQWlCLENBQUE7QUFDdkMsUUFBUSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsTUFBTSxHQUFHLEdBQUc7SUFDaEMsUUFBUSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsZUFBZSxHQUFHLFdBQVcsQ0FBQTtBQUNqRCxRQUFRLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxNQUFNLENBQUMsQ0FBQTtBQUNqQyxRQUFRLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxNQUFNLENBQUMsQ0FBQTtBQUVqQyxFQUFFLENBQUMsUUFBUSxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsSUFBSSxDQUFDLENBQUMsQ0FBQyxFQUFFLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFBO0FBQ25DLEVBQUUsQ0FBQyxNQUFNLENBQUMsRUFBRSxDQUFDLFNBQVMsQ0FBQyxDQUFBO0FBQ3ZCLEVBQUUsQ0FBQyxVQUFVLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUE7QUFDekIsRUFBRSxDQUFDLFVBQVUsQ0FBQyxPQUFPLENBQUMsQ0FBQTtBQUV0QixJQUFNLEtBQUssR0FBRyxJQUFJLENBQUMsR0FBRyxFQUFFLENBQUE7QUFDeEIsSUFBTSxHQUFHLEdBQUcsTUFBTSxDQUFDLHFCQUFxQixDQUFBO0FBRXhDLEdBQUcsQ0FBQztJQUNGLElBQU0sSUFBSSxHQUFHLElBQUksQ0FBQyxHQUFHLEVBQUUsQ0FBQTtJQUN2QixJQUFNLE1BQU0sR0FBRyxJQUFJLENBQUE7SUFFbkIsRUFBRSxDQUFDLENBQUUsSUFBSSxHQUFHLEtBQUssR0FBRyxJQUFLLENBQUMsQ0FBQyxDQUFDO1FBQzFCLEdBQUcsQ0FBQyxDQUFFLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsQ0FBQyxHQUFHLFlBQVksRUFBRSxDQUFDLElBQUksQ0FBQyxFQUFHLENBQUM7WUFDL0MsU0FBUyxDQUFDLENBQUMsQ0FBQyxHQUFHLFlBQUksQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsR0FBRyxNQUFNLEVBQUUsSUFBSSxDQUFDLENBQUMsQ0FBQyxHQUFHLE1BQU0sRUFBRSxTQUFTLENBQUMsQ0FBQyxDQUFDLEdBQUcsVUFBVSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUE7WUFDdEYsU0FBUyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxZQUFJLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLEdBQUcsTUFBTSxFQUFFLElBQUksQ0FBQyxDQUFDLENBQUMsR0FBRyxNQUFNLEVBQUUsU0FBUyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRSxVQUFVLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUE7UUFDbkcsQ0FBQztJQUNILENBQUM7SUFDRCxFQUFFLENBQUMsS0FBSyxDQUFDLEVBQUUsQ0FBQyxnQkFBZ0IsR0FBRyxFQUFFLENBQUMsZ0JBQWdCLENBQUMsQ0FBQTtJQUNuRCxFQUFFLENBQUMsU0FBUyxDQUFDLFdBQVcsQ0FBQyxNQUFNLEVBQUUsSUFBSSxDQUFDLENBQUE7SUFDdEMsRUFBRSxDQUFDLFNBQVMsQ0FBQyxXQUFXLENBQUMsWUFBWSxFQUFFLElBQUksQ0FBQyxDQUFDLENBQUMsRUFBRSxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQTtJQUN4RCxFQUFFLENBQUMsU0FBUyxDQUFDLFdBQVcsQ0FBQyxHQUFHLEVBQUUsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFBO0lBQ3pDLEVBQUUsQ0FBQyxTQUFTLENBQUMsV0FBVyxDQUFDLE9BQU8sRUFBRSxRQUFRLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxFQUFFLFFBQVEsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLEVBQUUsUUFBUSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFBO0lBQzFGLEVBQUUsQ0FBQyxVQUFVLENBQUMsV0FBVyxDQUFDLE9BQU8sRUFBRSxLQUFLLENBQUMsQ0FBQTtJQUN6QyxFQUFFLENBQUMsVUFBVSxDQUFDLFdBQVcsQ0FBQyxXQUFXLEVBQUUsU0FBUyxDQUFDLENBQUE7SUFDakQsRUFBRSxDQUFDLFVBQVUsQ0FBQyxFQUFFLENBQUMsU0FBUyxFQUFFLENBQUMsRUFBRSxRQUFRLENBQUMsQ0FBQTtJQUN4QyxHQUFHLENBQUMsTUFBTSxDQUFDLENBQUE7QUFDYixDQUFDLENBQUMsQ0FBQTs7OztBQ2pLRixpQkFBMEIsR0FBVyxFQUFFLEdBQVc7SUFDaEQsTUFBTSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLE1BQU0sRUFBRSxHQUFHLENBQUUsR0FBRyxHQUFHLEdBQUcsQ0FBRSxHQUFHLEdBQUcsQ0FBQyxDQUFBO0FBQ3hELENBQUM7QUFGRCwwQkFFQzs7OztBQ0ZELGNBQXVCLEdBQVcsRUFBRSxHQUFXLEVBQUUsR0FBVztJQUMxRCxFQUFFLENBQU0sQ0FBRSxHQUFHLEdBQUcsR0FBSSxDQUFDO1FBQUMsTUFBTSxDQUFDLEdBQUcsR0FBRyxDQUFFLEdBQUcsR0FBRyxHQUFHLENBQUUsQ0FBQTtJQUNoRCxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUUsR0FBRyxHQUFHLEdBQUksQ0FBQztRQUFDLE1BQU0sQ0FBQyxHQUFHLEdBQUcsQ0FBRSxHQUFHLEdBQUcsR0FBRyxDQUFFLENBQUE7SUFDaEQsSUFBSTtRQUFrQixNQUFNLENBQUMsR0FBRyxDQUFBO0FBQ2xDLENBQUM7QUFKRCxvQkFJQyIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCJpbXBvcnQgeyByYW5kSW50IH0gZnJvbSAnLi91dGlscy9yYW5kb20nXG5pbXBvcnQgeyB3cmFwIH0gZnJvbSAnLi91dGlscy9yYW5nZSdcblxuY29uc3QgY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnY2FudmFzJylcbmNvbnN0IHNsaWRlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0JylcbmNvbnN0IGdsID0gY2FudmFzLmdldENvbnRleHQoJ3dlYmdsJylcblxuaWYgKCBnbCA9PSBudWxsICkge1xuICB0aHJvdyBuZXcgRXJyb3IoJ2dsIGNvbnRleHQgY291bGQgbm90IGJlIG9idGFpbmVkJylcbn1cblxuY29uc3QgTUFYX1ZFQzRfVU5JRk9STV9TSVpFID0gZ2wuZ2V0UGFyYW1ldGVyKGdsLk1BWF9WRVJURVhfVU5JRk9STV9WRUNUT1JTKVxuY29uc3QgU1BIRVJFX0NPVU5UID0gTUFYX1ZFQzRfVU5JRk9STV9TSVpFIC8gNFxuY29uc3QgQVJFQSA9IFsgODAwLCA0NTAgXVxuXG5jb25zdCByYWRpaSA9IG5ldyBGbG9hdDMyQXJyYXkoU1BIRVJFX0NPVU5UKVxuY29uc3QgcG9zaXRpb25zID0gbmV3IEZsb2F0MzJBcnJheSgyICogU1BIRVJFX0NPVU5UKVxuY29uc3QgdmVsb2NpdGllcyA9IG5ldyBGbG9hdDMyQXJyYXkoMiAqIFNQSEVSRV9DT1VOVClcbmNvbnN0IHNldHRpbmdzID0ge1xuICBLOiAwLjEsXG4gIGNvbG9yOiBbIC4yLCAuNCwgLjggXVxufVxuXG5mb3IgKCB2YXIgaSA9IDA7IGkgPCBTUEhFUkVfQ09VTlQ7IGkrKyApIHtcbiAgcmFkaWlbaV0gPSByYW5kSW50KDQsIDMwKVxuICBwb3NpdGlvbnNbaSAqIDJdID0gcmFuZEludCgwLCBBUkVBWzBdKVxuICBwb3NpdGlvbnNbaSAqIDIgKyAxXSA9IHJhbmRJbnQoMCwgQVJFQVsxXSlcbiAgdmVsb2NpdGllc1tpICogMl0gPSByYW5kSW50KC00LCA0KVxuICB2ZWxvY2l0aWVzW2kgKiAyICsgMV0gPSByYW5kSW50KC00LCA0KVxufVxuXG5jb25zdCB2c3JjID0gXG5gXG5wcmVjaXNpb24gbWVkaXVtcCBmbG9hdDtcblxuYXR0cmlidXRlIHZlYzIgYV92ZXJ0aWNlcztcblxudm9pZCBtYWluICgpIHtcbiAgZ2xfUG9zaXRpb24gPSB2ZWM0KGFfdmVydGljZXMsIDEuMCwgMS4wKTtcbn1cbmBcblxuY29uc3QgZnNyYyA9XG5gXG5wcmVjaXNpb24gbWVkaXVtcCBmbG9hdDtcblxudW5pZm9ybSB2ZWMyIHVfcmVzb2x1dGlvbjtcbnVuaWZvcm0gZmxvYXQgdV90aW1lO1xudW5pZm9ybSBmbG9hdCB1X0s7XG51bmlmb3JtIHZlYzMgdV9jb2xvcjtcbnVuaWZvcm0gZmxvYXQgdV9yYWRpaSBbICR7IFNQSEVSRV9DT1VOVCB9IF07XG51bmlmb3JtIHZlYzIgdV9wb3NpdGlvbnMgWyAkeyBTUEhFUkVfQ09VTlQgfSBdO1xuXG5mbG9hdCBzZGZfc3BoZXJlICggZmxvYXQgciwgdmVjMiBjLCB2ZWMyIHAgKSB7XG4gIHJldHVybiBkaXN0YW5jZShwLCBjKSAtIHI7XG59XG5cbnZvaWQgbWFpbiAoKSB7XG4gIHZlYzIgcCA9IGdsX0ZyYWdDb29yZC54eTtcbiAgZmxvYXQgZGlzdCA9IDAuO1xuXG4gIGZvciAoIGludCBpID0gMDsgaSA8ICR7IFNQSEVSRV9DT1VOVCB9OyBpKysgKSB7XG4gICAgZGlzdCArPSBleHAoLXVfSyAqIHNkZl9zcGhlcmUodV9yYWRpaVtpXSwgdV9wb3NpdGlvbnNbaV0sIHApKTtcbiAgfVxuICBkaXN0ID0gLWxvZyhkaXN0KSAvIHVfSztcbiAgZmxvYXQgb3BhY2l0eSA9IGNsYW1wKC41IC0gZGlzdCwgMC4wLCAxLjApO1xuXG4gIGdsX0ZyYWdDb2xvciA9IHZlYzQodV9jb2xvciwgb3BhY2l0eSk7XG59XG5gXG5cbmNvbnN0IHZlcnRleCA9IGdsLmNyZWF0ZVNoYWRlcihnbC5WRVJURVhfU0hBREVSKVxuY29uc3QgZnJhZ21lbnQgPSBnbC5jcmVhdGVTaGFkZXIoZ2wuRlJBR01FTlRfU0hBREVSKVxuY29uc3QgcHJvZ3JhbSA9IGdsLmNyZWF0ZVByb2dyYW0oKVxuY29uc3Qgc2NyZWVuUXVhZCA9IG5ldyBGbG9hdDMyQXJyYXkoW1xuICAtMSwgMSwgLTEsIC0xLCAxLCAtMSxcbiAgLTEsIDEsIDEsIC0xLCAxLCAxXG5dKSBcbmNvbnN0IHF1YWRTaXplID0gc2NyZWVuUXVhZC5sZW5ndGggLyAyIFxuXG5pZiAoIHZlcnRleCA9PSBudWxsICYmIGZyYWdtZW50ID09IG51bGwgJiYgcHJvZ3JhbSA9PSBudWxsICkge1xuICB0aHJvdyBuZXcgRXJyb3IoJ2dsIHJlc291cmNlcyBjb3VsZCBub3QgYmUgb2J0YWluZWQnKVxufVxuXG5nbC5zaGFkZXJTb3VyY2UodmVydGV4LCB2c3JjKVxuZ2wuY29tcGlsZVNoYWRlcih2ZXJ0ZXgpXG5nbC5zaGFkZXJTb3VyY2UoZnJhZ21lbnQsIGZzcmMpXG5nbC5jb21waWxlU2hhZGVyKGZyYWdtZW50KVxuXG5nbC5hdHRhY2hTaGFkZXIocHJvZ3JhbSwgdmVydGV4KVxuZ2wuYXR0YWNoU2hhZGVyKHByb2dyYW0sIGZyYWdtZW50KVxuZ2wubGlua1Byb2dyYW0ocHJvZ3JhbSlcbmdsLnVzZVByb2dyYW0ocHJvZ3JhbSlcblxuaWYgKCAhZ2wuZ2V0UHJvZ3JhbVBhcmFtZXRlcihwcm9ncmFtLCBnbC5MSU5LX1NUQVRVUykgKSB7XG4gIGNvbnNvbGUubG9nKGdsLmdldFNoYWRlckluZm9Mb2codmVydGV4KSlcbiAgY29uc29sZS5sb2coZ2wuZ2V0U2hhZGVySW5mb0xvZyhmcmFnbWVudCkpXG4gIGNvbnNvbGUubG9nKGdsLmdldFByb2dyYW1JbmZvTG9nKHByb2dyYW0pKVxufVxuXG5jb25zdCB2ZXJ0aWNlc0J1ZmZlciA9IGdsLmNyZWF0ZUJ1ZmZlcigpXG5jb25zdCBhX2xvY2F0aW9ucyA9IHtcbiAgYV92ZXJ0aWNlczogZ2wuZ2V0QXR0cmliTG9jYXRpb24ocHJvZ3JhbSwgJ2FfdmVydGljZXMnKVxufVxuY29uc3QgdV9sb2NhdGlvbnMgPSB7XG4gIHVfSzogZ2wuZ2V0VW5pZm9ybUxvY2F0aW9uKHByb2dyYW0sICd1X0snKSBhcyBXZWJHTFVuaWZvcm1Mb2NhdGlvbixcbiAgdV9jb2xvcjogZ2wuZ2V0VW5pZm9ybUxvY2F0aW9uKHByb2dyYW0sICd1X2NvbG9yJykgYXMgV2ViR0xVbmlmb3JtTG9jYXRpb24sXG4gIHVfdGltZTogZ2wuZ2V0VW5pZm9ybUxvY2F0aW9uKHByb2dyYW0sICd1X3RpbWUnKSBhcyBXZWJHTFVuaWZvcm1Mb2NhdGlvbixcbiAgdV9yZXNvbHV0aW9uOiBnbC5nZXRVbmlmb3JtTG9jYXRpb24ocHJvZ3JhbSwgJ3VfcmVzb2x1dGlvbicpIGFzIFdlYkdMVW5pZm9ybUxvY2F0aW9uLFxuICB1X3JhZGlpOiBnbC5nZXRVbmlmb3JtTG9jYXRpb24ocHJvZ3JhbSwgJ3VfcmFkaWknKSBhcyBXZWJHTFVuaWZvcm1Mb2NhdGlvbixcbiAgdV9wb3NpdGlvbnM6IGdsLmdldFVuaWZvcm1Mb2NhdGlvbihwcm9ncmFtLCAndV9wb3NpdGlvbnMnKSBhcyBXZWJHTFVuaWZvcm1Mb2NhdGlvblxufVxuXG5nbC5iaW5kQnVmZmVyKGdsLkFSUkFZX0JVRkZFUiwgdmVydGljZXNCdWZmZXIpXG5nbC5lbmFibGVWZXJ0ZXhBdHRyaWJBcnJheShhX2xvY2F0aW9ucy5hX3ZlcnRpY2VzKVxuZ2wudmVydGV4QXR0cmliUG9pbnRlcihhX2xvY2F0aW9ucy5hX3ZlcnRpY2VzLCAyLCBnbC5GTE9BVCwgZmFsc2UsIDAsIDApXG5nbC5idWZmZXJEYXRhKGdsLkFSUkFZX0JVRkZFUiwgc2NyZWVuUXVhZCwgZ2wuU1RBVElDX0RSQVcpXG5cbnNsaWRlci50eXBlID0gJ3JhbmdlJ1xuc2xpZGVyLm1pbiA9ICcwJ1xuc2xpZGVyLm1heCA9ICcwLjEnXG5zbGlkZXIuc3RlcCA9ICcwLjAxJ1xuc2xpZGVyLnZhbHVlID0gc2V0dGluZ3MuSy50b1N0cmluZygpXG5zbGlkZXIuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCBfID0+IHNldHRpbmdzLksgPSBOdW1iZXIoc2xpZGVyLnZhbHVlKSlcblxuY2FudmFzLndpZHRoID0gQVJFQVswXVxuY2FudmFzLmhlaWdodCA9IEFSRUFbMV1cbmNhbnZhcy5zdHlsZS5ib3hTaXppbmcgPSAnYm9yZGVyLWJveCdcbmNhbnZhcy5zdHlsZS5ib3JkZXIgPSAnMnB4IHNvbGlkIENvcmFsJ1xuZG9jdW1lbnQuYm9keS5zdHlsZS5tYXJnaW4gPSAnMCcsXG5kb2N1bWVudC5ib2R5LnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICdNaXN0eVJvc2UnXG5kb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGNhbnZhcylcbmRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoc2xpZGVyKVxuXG5nbC52aWV3cG9ydCgwLCAwLCBBUkVBWzBdLCBBUkVBWzFdKVxuZ2wuZW5hYmxlKGdsLkNVTExfRkFDRSlcbmdsLmNsZWFyQ29sb3IoMCwgMCwgMCwgMClcbmdsLnVzZVByb2dyYW0ocHJvZ3JhbSlcblxuY29uc3Qgc3RhcnQgPSBEYXRlLm5vdygpXG5jb25zdCByYWYgPSB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lXG5cbnJhZihmdW5jdGlvbiByZW5kZXIoKSB7XG4gIGNvbnN0IHRpbWUgPSBEYXRlLm5vdygpXG4gIGNvbnN0IGJ1ZmZlciA9IDEuMDVcblxuICBpZiAoIHRpbWUgLSBzdGFydCA+IDEwMDAgKSB7XG4gICAgZm9yICggdmFyIGkgPSAwOyBpIDwgMiAqIFNQSEVSRV9DT1VOVDsgaSArPSAyICkge1xuICAgICAgcG9zaXRpb25zW2ldID0gd3JhcCgtQVJFQVswXSAqIGJ1ZmZlciwgQVJFQVswXSAqIGJ1ZmZlciwgcG9zaXRpb25zW2ldICsgdmVsb2NpdGllc1tpXSlcbiAgICAgIHBvc2l0aW9uc1tpICsgMV0gPSB3cmFwKC1BUkVBWzFdICogYnVmZmVyLCBBUkVBWzFdICogYnVmZmVyLCBwb3NpdGlvbnNbaSArIDFdKyB2ZWxvY2l0aWVzW2kgKyAxXSlcbiAgICB9XG4gIH1cbiAgZ2wuY2xlYXIoZ2wuQ09MT1JfQlVGRkVSX0JJVCB8IGdsLkRFUFRIX0JVRkZFUl9CSVQpXG4gIGdsLnVuaWZvcm0xZih1X2xvY2F0aW9ucy51X3RpbWUsIHRpbWUpXG4gIGdsLnVuaWZvcm0yZih1X2xvY2F0aW9ucy51X3Jlc29sdXRpb24sIEFSRUFbMF0sIEFSRUFbMV0pXG4gIGdsLnVuaWZvcm0xZih1X2xvY2F0aW9ucy51X0ssIHNldHRpbmdzLkspXG4gIGdsLnVuaWZvcm0zZih1X2xvY2F0aW9ucy51X2NvbG9yLCBzZXR0aW5ncy5jb2xvclswXSwgc2V0dGluZ3MuY29sb3JbMV0sIHNldHRpbmdzLmNvbG9yWzJdKVxuICBnbC51bmlmb3JtMWZ2KHVfbG9jYXRpb25zLnVfcmFkaWksIHJhZGlpKVxuICBnbC51bmlmb3JtMmZ2KHVfbG9jYXRpb25zLnVfcG9zaXRpb25zLCBwb3NpdGlvbnMpXG4gIGdsLmRyYXdBcnJheXMoZ2wuVFJJQU5HTEVTLCAwLCBxdWFkU2l6ZSlcbiAgcmFmKHJlbmRlcilcbn0pXG4iLCJleHBvcnQgZnVuY3Rpb24gcmFuZEludCAoIG1pbjogbnVtYmVyLCBtYXg6IG51bWJlciApOiBudW1iZXIge1xuICByZXR1cm4gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogKCBtYXggLSBtaW4gKSArIG1pbilcbn1cbiIsImV4cG9ydCBmdW5jdGlvbiB3cmFwICggbWluOiBudW1iZXIsIG1heDogbnVtYmVyLCB2YWw6IG51bWJlciApOiBudW1iZXIge1xuICBpZiAgICAgICggdmFsID4gbWF4ICkgcmV0dXJuIG1pbiArICggdmFsIC0gbWF4IClcbiAgZWxzZSBpZiAoIHZhbCA8IG1pbiApIHJldHVybiBtYXggKyAoIG1pbiAtIHZhbCApXG4gIGVsc2UgICAgICAgICAgICAgICAgICByZXR1cm4gdmFsXG59XG4iXX0=
